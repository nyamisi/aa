ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/5)+
geom_stratum(aes(fill = field), width = 1/5)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/4)+
geom_stratum(aes(fill = field), width = 1/4)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis2 = gender, axis3 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>% filter(field == "GIS")
student %>% filter(field == "GIS") %>% select(title)
student
student %>% filter(field == "GIS") %>% select(Title)
ggsave("aa.pdf")
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
# mutate(field = replace(field))
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(field = replace(field, field == "GIS", "fishery")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(field = replace(field, field == "GIS", "fishery"),
field = replace(field, field == "plankton", "ecosystem")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>% filter(field == "physical")
student %>% filter(field == "physical") %>% select(Title)
student %>%
mutate(field = replace(field, field == "GIS", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
# scale_fill_brewer(palette = "Dark2")+
scale_x_discrete(expand = c(0.1,0.05))
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")+
# scale_x_discrete(expand = c(0.1,0.05))
ggsave("aa.pdf")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year == 2020) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(between(year,2020,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2020,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "spline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "linear", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = reorder(field), y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = reorder(field,n), y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = reorder(field,-n), y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
require(tidyverse)
require(readxl)
require(tm)           # for text mining
require(SnowballC)    # for text stemming
require(wordcloud)    # word-cloud generator
require(RColorBrewer) # color palettes
require(wordcloud2)
require(ggalluvial)
student = read_excel("student_2020-23.xlsx")
student.text = student$Title
student.doc = tm::Corpus(VectorSource(student.text))
#| warning: false
#| message: false
student.doc.clean = student.doc %>%
tm_map(removeNumbers) %>%
tm_map(removePunctuation) %>%
tm_map(stripWhitespace) %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removeWords, stopwords(kind = "en"))
student.matrix = TermDocumentMatrix(student.doc.clean) %>%
as.matrix()
student.word = sort(rowSums(student.matrix), decreasing = TRUE)
student.word.df = data.frame(word = names(student.word), freq = student.word)
#| warning: false
#| message: false
set.seed(1234) # for reproducibility
wordcloud(words = student.word.df$word,
freq = student.word.df$freq,
min.freq = 1,
random.order = FALSE,
max.words = 200,
# rot.per = 0.35,
colors = brewer.pal(8, "Dark2"),
scale = c(3.5,0.4))
#| warning: false
#| message: false
set.seed(1234) # for reproducibility
wordcloud(words = student.word.df$word,
freq = student.word.df$freq,
min.freq = 3,
random.order = FALSE,
# max.words = 1000,
# rot.per = 0.35,
colors = brewer.pal(8, "Dark2"),
scale = c(3.5,0.6))
wordcloud2(data = student.word.df, size = 0.8, color = "random-dark", minSize = 3,ellipticity = 2,gridSize = 11)
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
# scale_x_discrete(expand = c(0.1,0.05))
# ggsave("aa.pdf")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
filter(year %in% c(2021,2023)) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "xspline", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "none")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
# scale_x_discrete(expand = c(0.1,0.05))
# ggsave("aa.pdf")
student %>%
mutate(field = replace(field, field == "GIS" | field == "policy", "fishery"),
field = replace(field, field == "plankton", "ecosystem"),
field = replace(field, field == "physical", "pollution")) %>%
mutate(year = as.factor(year)) %>%
group_by(gender, field, year) %>%
count() %>%
ggplot(aes(axis1 = year, axis3 = gender, axis2 = field, y = n)) +
geom_alluvium(aes(fill = field), curve_type = "sigmoid", alpha = 0.6, width = 1/3)+
geom_stratum(aes(fill = field), width = 1/3)+
geom_label(stat = "stratum", aes(label = after_stat(stratum)), size = 3, alpha = 0.6)+
theme_void()+
theme(legend.position = "right")+
ggsci::scale_fill_futurama()+
scale_fill_brewer(palette = "Dark2")
